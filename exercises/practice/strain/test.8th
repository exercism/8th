import {unitt}!
import {src/strain}!

suite "Strain" [
    test "keep on empty list returns empty list" [
        result: keep [] ( drop true )
        assert -> [] = result
    ]

    test.skip "keeps everything" [
        result: keep [1, 3, 5] ( drop true )
        assert -> [1, 3, 5] = result
    ]

    test.skip "keeps nothing" [
        result: keep [1, 3, 5] ( drop false )
        assert -> [] = result
    ]

    test.skip "keeps first and last" [
        result: keep [1, 2, 3] ( 2 n:mod 1 n:= )
        assert -> [1, 3] = result
    ]

    test.skip "keeps neither first nor last" [
        result: keep [1, 2, 3] ( 2 n:mod 0 n:= )
        assert -> [2] = result
    ]

    test.skip "keeps strings" [
        result: keep ["apple", "zebra", "banana", "zombies", "cherimoya", "zealot"] ( 0 s:@ nip 'z n:= )
        assert -> ["zebra", "zombies", "zealot"] = result
    ]

    test.skip "keeps lists" [
        result: keep [[1, 2, 3], [5, 5, 5], [5, 1, 2], [2, 1, 2], [1, 5, 2], [2, 2, 1], [1, 2, 5]] ( 5 ' n:= a:indexof nip number? nip )
        assert -> [[5, 5, 5], [5, 1, 2], [1, 5, 2], [1, 2, 5]] = result
    ]

    test.skip "discard on empty list returns empty list" [
        result: discard [] ( drop true )
        assert -> [] = result
    ]

    test.skip "discards everything" [
        result: discard [1, 3, 5] ( drop true )
        assert -> [] = result
    ]

    test.skip "discards nothing" [
        result: discard [1, 3, 5] ( drop false )
        assert -> [1, 3, 5] = result
    ]

    test.skip "discards first and last" [
        result: discard [1, 2, 3] ( 2 n:mod 1 n:= )
        assert -> [2] = result
    ]

    test.skip "discards neither first nor last" [
        result: discard [1, 2, 3] ( 2 n:mod 0 n:= )
        assert -> [1, 3] = result
    ]

    test.skip "discards strings" [
        result: discard ["apple", "zebra", "banana", "zombies", "cherimoya", "zealot"] ( 0 s:@ nip 'z n:= )
        assert -> ["apple", "banana", "cherimoya"] = result
    ]

    test.skip "discards lists" [
        result: discard [[1, 2, 3], [5, 5, 5], [5, 1, 2], [2, 1, 2], [1, 5, 2], [2, 2, 1], [1, 2, 5]] ( 5 ' n:= a:indexof nip number? nip )
        assert -> [[1, 2, 3], [2, 1, 2], [2, 2, 1]] = result
    ]
]
